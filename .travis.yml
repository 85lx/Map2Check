dist: xenial
#sudo: require

language: cpp

services: 
  - docker

before_script:
    - python utils/cpplint.py --headers=hpp,h --linelength=120  --recursive --counting=detailed modules/frontend
    - python utils/cpplint.py --headers=hpp,h --linelength=120  --recursive --counting=detailed modules/backend/pass
    - docker build -t hrocha/mapdevel --no-cache -f Dockerfile .    
    - docker build -t hrocha/benchexecrun --no-cache -f utils/benchexecrun/Dockerfile utils/benchexecrun/ 

script:    
    - docker run --rm -v $(pwd):/home/map2check/devel_tool/mygitclone:Z --user $(id -u):$(id -g) hrocha/mapdevel /bin/bash -c "cd /home/map2check/devel_tool/mygitclone; ./make-release.sh; ./make-unit-test.sh" 
    - ./make-regression-test.sh travis

notifications:
  email:
    recipients:
      - herberthb12@gmail.com
      - rafa.sa.xp@gmail.com
    on_success: never # default: change
    on_failure: never # default: always
